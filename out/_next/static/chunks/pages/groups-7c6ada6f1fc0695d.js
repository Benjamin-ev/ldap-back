(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[736],{7789:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/groups",function(){return n(28)}])},5789:function(e,t,n){"use strict";n.d(t,{Z:function(){return p}});var s=n(5893),r=n(3532),o=n.n(r),i=n(1664),u=n.n(i),a=n(9008),l=n.n(a),c=n(1163),d=n.n(c);function p(e){return(0,s.jsxs)("div",{className:o().container,children:[(0,s.jsxs)(l(),{children:[(0,s.jsx)("meta",{name:"description",content:"Managing page for boquette FR"}),(0,s.jsx)("link",{rel:"icon",href:"/favicon.svg"}),(0,s.jsx)("title",{children:"A&M Boquette - Gestion LDAP"})]}),(0,s.jsxs)("header",{className:o().header,children:[(0,s.jsxs)("div",{className:o().subHeader,children:[(0,s.jsx)(u(),{href:"/users",passHref:!0,children:(0,s.jsx)("h2",{className:[o().bouton,"/users"==d().pathname?o().selectedBouton:void 0].join(" "),children:"Gestion des Utilisateurs"})}),(0,s.jsx)(u(),{href:"/groups",passHref:!0,children:(0,s.jsx)("h2",{className:[o().bouton,"/groups"==d().pathname?o().selectedBouton:void 0].join(" "),children:"Gestion des Groupes"})})]}),(0,s.jsxs)("div",{className:o().subHeader,children:[(0,s.jsx)(u(),{href:d().pathname,passHref:!0,children:(0,s.jsx)("h2",{className:[o().bouton,d().query.action?void 0:o().selectedBouton].join(" "),children:"Visualiser"})}),(0,s.jsx)(u(),{href:d().pathname+"?action=add",passHref:!0,children:(0,s.jsx)("h2",{className:[o().bouton,"add"==d().query.action?o().selectedBouton:void 0].join(" "),children:"Ajouter"})}),(0,s.jsx)(u(),{href:d().pathname+"?action=edit",passHref:!0,children:(0,s.jsx)("h2",{className:[o().bouton,"edit"==d().query.action?o().selectedBouton:void 0].join(" "),children:"Editer"})}),"/groups"==d().pathname?(0,s.jsx)(u(),{href:d().pathname+"?action=transfert",passHref:!0,children:(0,s.jsx)("h2",{className:[o().bouton,"transfert"==d().query.action?o().selectedBouton:void 0].join(" "),children:"Transf\xe9rer"})}):void 0]})]}),(0,s.jsx)("main",{className:o().main,children:e.children})]})}},28:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return v}});var s=n(5893),r=n(1163),o=n.n(r),i=n(7294),u=n(1664),a=n.n(u),l=n(1287),c=n(5789),d=n(4542),p=n.n(d),h=n(2411);function f(){var e=(0,i.useState)([]),t=e[0],n=e[1],r=(0,i.useState)(""),u=r[0],l=r[1];return(0,i.useEffect)((function(){(0,h.Z)("/groups").then((function(e){n(e)}))}),[o().asPath]),(0,s.jsx)(c.Z,{children:(0,s.jsxs)("table",{className:p().table,children:[(0,s.jsxs)("thead",{children:[(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:p().colonne,children:"cn"}),(0,s.jsx)("th",{className:p().colonne,children:"description"}),(0,s.jsx)("th",{className:p().colonne,children:"gidNumber"}),(0,s.jsx)("th",{className:p().colonne,children:"strass"})]}),(0,s.jsx)("tr",{children:(0,s.jsx)("td",{children:(0,s.jsx)("input",{type:"text",onChange:function(e){return l(e.target.value)},placeholder:"filtrer"})})})]}),(0,s.jsx)("tbody",{children:null===t||void 0===t?void 0:t.map((function(e,t){return-1!=e.cn.toLowerCase().indexOf(u.toLowerCase())?(0,s.jsx)(a(),{href:o().pathname+"?action=edit&cn="+e.cn,passHref:!0,children:(0,s.jsxs)("tr",{className:p().rowHighlight,children:[(0,s.jsx)("td",{className:p().row,children:e.cn},t+"cn"),(0,s.jsx)("td",{className:p().row,children:e.description},t+"description"),(0,s.jsx)("td",{className:p().row,children:e.gidNumber},t+"gid"),(0,s.jsx)("td",{className:p().row,children:e.strass},t+"strass")]},t+"tr")},t+"link"):void 0}))})]})})}function m(){var e=(0,i.useState)(""),t=e[0],n=e[1],r=(0,i.useState)(""),u=r[0],a=r[1],l=(0,i.useState)(""),d=l[0],f=l[1],m=(0,i.useState)(!1),x=m[0],j=m[1];(0,i.useEffect)((function(){x&&setTimeout((function(){alert(x),j(!1)}),100)}),[x]);return(0,s.jsx)(c.Z,{children:(0,s.jsxs)("form",{onSubmit:function(e){e.preventDefault(),(0,h.W)("/groups","POST",{cn:t,description:u,strass:d}).then((function(e){200==e?(o().push("/groups"),j("Groupe ajout\xe9 !")):j("Erreur lors de la cr\xe9ation")}))},children:[(0,s.jsxs)("table",{className:p().table,children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:p().colonne,children:"cn"}),(0,s.jsx)("th",{className:p().colonne,children:"description"}),(0,s.jsx)("th",{className:p().colonne,children:"strass"})]})}),(0,s.jsx)("tbody",{children:(0,s.jsxs)("tr",{className:p().rowHighlight,children:[(0,s.jsx)("td",{className:p().row,children:(0,s.jsx)("input",{type:"text",onChange:function(e){return n(e.target.value)}})},"cn"),(0,s.jsx)("td",{className:p().row,children:(0,s.jsx)("input",{type:"text",onChange:function(e){return a(e.target.value)}})},"description"),(0,s.jsx)("td",{className:p().row,children:(0,s.jsx)("input",{type:"text",onChange:function(e){return f(e.target.value)}})},"strass")]},"tr")})]}),(0,s.jsx)("div",{children:(0,s.jsx)("button",{type:"submit",className:p().bouton,children:"Ajouter un groupe"})})]})})}function x(){var e=(0,i.useState)(""),t=e[0],n=e[1],r=(0,i.useState)(""),u=r[0],a=r[1],d=(0,i.useState)(""),f=d[0],m=d[1],x=(0,i.useState)(""),j=x[0],g=x[1],v=(0,i.useState)([]),_=v[0],N=v[1],y=(0,i.useState)([]),w=y[0],C=y[1],S=(0,i.useState)(!0),T=S[0],E=S[1],H=(0,i.useState)(""),k=H[0],A=H[1],L=(0,i.useState)(""),B=L[0],O=L[1],M=(0,i.useState)(!1),U=M[0],Z=M[1];(0,i.useEffect)((function(){U&&setTimeout((function(){alert(U),Z(!1)}),100)}),[U]),(0,i.useEffect)((function(){!o().query.cn&&T||((0,h.Z)("/groups/group/"+o().query.cn).then((function(e){n(e[0].dn),a(e[0].cn),m(e[0].description),g(e[0].strass),N(e[0].memberUid)})),(0,h.Z)("/users").then((function(e){return C(e)})),E(!0))}),[o().query.cn,T]);var q=function(e,t){(0,h.W)("/groups","PATCH",{user:e,cn:u,action:t}).then((function(e){200==e&&E(!1)}))};return(0,s.jsxs)(c.Z,{children:[(0,s.jsxs)("form",{onSubmit:function(e){e.preventDefault(),(0,h.W)("/groups","PUT",{dn:t,cn:u,description:f,strass:j}).then((function(e){200==e?(o().push("/groups"),Z("Groupe modifi\xe9 !")):Z("Erreur lors de la modification")}))},children:[(0,s.jsxs)("table",{className:p().table,children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:p().colonne,children:"cn"}),(0,s.jsx)("th",{className:p().colonne,children:"description"}),(0,s.jsx)("th",{className:p().colonne,children:"strass"})]})}),(0,s.jsx)("tbody",{children:u?(0,s.jsxs)("tr",{className:p().rowHighlight,children:[(0,s.jsx)("td",{className:p().row,children:(0,s.jsx)("input",{type:"text",onChange:function(e){return a(e.target.value)},value:u,disabled:!0})},"cn"),(0,s.jsx)("td",{className:p().row,children:(0,s.jsx)("input",{type:"text",onChange:function(e){return m(e.target.value)},value:f})},"description"),(0,s.jsx)("td",{className:p().row,children:(0,s.jsx)("input",{type:"text",onChange:function(e){return g(e.target.value)},value:j})},"strass")]},"tr"):void 0})]}),(0,s.jsx)("div",{children:(0,s.jsx)("button",{type:"submit",className:p().bouton,children:"Modifier"})})]}),(0,s.jsx)(l.Z,{handleFiles:function(e){var t=new FileReader;t.onload=function(e){(0,h.W)("/groups/users","PATCH",{users:t.result.split("\r\n"),cn:u}).then((function(e){200==e?(o().push("/groups"),Z("Utilisateurs ajout\xe9s !")):Z("Erreur lors de l'ajout")}))},t.readAsText(e[0])},fileTypes:".csv",children:(0,s.jsx)("button",{className:p().bouton,children:"Importer"})}),(0,s.jsx)("button",{onClick:function(){(0,h.W)("/groups","DELETE",{cn:u}).then((function(e){200==e?(o().push("/groups"),Z("Groupe supprim\xe9 !")):Z("Erreur lors de la suppression")}))},className:p().bouton,children:"Supprimer le groupe"}),(0,s.jsx)("button",{onClick:function(){(0,h.W)("/groups/all","DELETE",{memberUid:_,cn:u}).then((function(e){200==e?(o().push("/groups"),Z("Utilisateurs retir\xe9s !")):Z("Erreur")}))},className:p().bouton,children:"Supprimer TOUS les utilisateurs"}),"TRUE"==j?(0,s.jsx)(b,{cn:u,memberUid:_,setMountedUsers:E}):void 0,(0,s.jsxs)("div",{className:p().groupManage,children:[(0,s.jsxs)("div",{className:p().groupMembers,children:[(0,s.jsx)("h1",{children:"Membres du groupe"}),(0,s.jsx)("input",{type:"text",onChange:function(e){return A(e.target.value)},placeholder:"filtrer"}),(0,s.jsx)("ul",{className:p().list,children:_?"object"==typeof _?_.map((function(e){return-1!=e.indexOf(k.toLowerCase())?(0,s.jsx)("button",{className:p().defaultButton,onClick:function(){return q(e,"delete")},children:(0,s.jsx)("li",{className:p().eltLi,children:e},e)},e+"button"):void 0})):-1!=_.indexOf(k.toLowerCase())?(0,s.jsx)("button",{className:p().defaultButton,onClick:function(){return q(_,"delete")},children:(0,s.jsx)("li",{className:p().eltLi,children:_},_)},"button"):void 0:void 0})]}),(0,s.jsxs)("div",{className:p().groupMembers,children:[(0,s.jsx)("h1",{children:"Autres utilisateurs"}),(0,s.jsx)("input",{type:"text",onChange:function(e){return O(e.target.value)},placeholder:"filtrer"}),(0,s.jsx)("ul",{className:p().list,children:null===w||void 0===w?void 0:w.map((function(e){return-1==e.uid.indexOf(B.toLowerCase())||(null===_||void 0===_?void 0:_.includes(e.uid))?void 0:(0,s.jsx)("button",{className:p().defaultButton,onClick:function(){return q(e.uid,"add")},children:(0,s.jsx)("li",{className:p().eltLi,children:e.uid},e.uid)},e.uid+"button")}))})]})]})]})}function j(){var e=(0,i.useState)([]),t=e[0],n=e[1],r=(0,i.useState)(""),u=r[0],a=r[1],l=(0,i.useState)(""),d=l[0],f=l[1],m=(0,i.useState)(!0),x=m[0],j=m[1];(0,i.useEffect)((function(){(0,h.Z)("/groups").then((function(e){n(e),a(e[0].cn)}))}),[]);return(0,s.jsxs)(c.Z,{children:[(0,s.jsxs)("div",{className:p().subHeader,children:[(0,s.jsx)("button",{className:[p().choice,x?p().selectedBouton:void 0].join(" "),onClick:function(){return j(!0)},children:"Copier le Groupe"}),(0,s.jsx)("button",{className:[p().choice,x?void 0:p().selectedBouton].join(" "),onClick:function(){return j(!1)},children:"Couper le Groupe"})]}),(0,s.jsxs)("form",{onSubmit:function(){(0,h.W)("/groups/transfert","PATCH",{oldGroup:u,newGroup:d,action:x}).then((function(e){200==e?(o().push("/groups"),setAlert("Transfert r\xe9ussi !")):setAlert("Erreur lors du transfert")}))},className:p().subHeader,children:[(0,s.jsxs)("div",{className:p().partHeader,children:[(0,s.jsx)("h3",{children:"Ancien Groupe"}),(0,s.jsx)("select",{className:p().choice,onChange:function(e){return a(e.target.value)},children:null===t||void 0===t?void 0:t.map((function(e){return e.cn!==d?(0,s.jsx)("option",{value:e.cn,children:e.cn},e.cn):void 0}))})]}),(0,s.jsxs)("div",{className:p().partHeader,children:[(0,s.jsx)("h3",{children:"Nouveau Groupe"}),(0,s.jsx)("select",{className:p().choice,onChange:function(e){return f(e.target.value)},children:null===t||void 0===t?void 0:t.map((function(e){return e.cn!==u?(0,s.jsx)("option",{value:e.cn,children:e.cn},e.cn):void 0}))})]}),(0,s.jsx)("div",{className:p().partHeader,children:(0,s.jsx)("button",{type:"submit",className:p().choice,children:"Transf\xe9rer"})})]})]})}function b(e){var t=e.cn,n=e.memberUid,r=e.setMountedUsers,o=(0,i.useState)(!1),u=o[0],a=o[1],l=(0,i.useState)([]),c=l[0],d=l[1],f=(0,i.useState)([]),m=f[0],x=f[1];(0,i.useEffect)((function(){u||(0,h.Z)("/groups/bouls/"+t).then((function(e){d(e);for(var t=Object.values(n),s=0;s<e.length;s++){var r=t.indexOf(e[s].uid);-1!==r&&t.splice(r,1)}x(t),a(!0)}))}),[u]);var j=function(e,t){(0,h.W)("/groups/bouls","PUT",{uid:t,bouls:e,action:"delete"}).then((function(e){200==e&&a(!1)}))};return(0,s.jsxs)(s.Fragment,{children:[null===c||void 0===c?void 0:c.map((function(e){return"object"==typeof e.bouls?n.includes(e.uid)?e.bouls.map((function(n){return n.includes(t)?(0,s.jsxs)("div",{children:[(0,s.jsx)("input",{type:"text",className:p().input,value:e.uid,disabled:!0}),(0,s.jsx)("input",{type:"text",className:p().input,value:n.split(":")[1],disabled:!0}),(0,s.jsx)("button",{onClick:function(){return j(n,e.uid)},className:p().bouton,children:"Supprimer"})]},e.uid):void 0})):void 0:e.bouls.includes(t)&&n.includes(e.uid)?(0,s.jsxs)("div",{children:[(0,s.jsx)("input",{type:"text",className:p().input,value:e.uid,disabled:!0}),(0,s.jsx)("input",{type:"text",className:p().input,value:e.bouls.split(":")[1],disabled:!0}),(0,s.jsx)("button",{onClick:function(){return j(e.bouls,e.uid)},className:p().bouton,children:"Supprimer"})]},e.uid):void 0})),""!==m?"object"==typeof m?null===m||void 0===m?void 0:m.map((function(e){return(0,s.jsx)(g,{cn:t,user:e,setMounted:a,setMountedUsers:r},e)})):(0,s.jsx)(g,{cn:t,user:m,setMounted:a,setMountedUsers:r}):void 0]})}function g(e){var t=e.cn,n=e.user,r=e.setMounted,o=e.setMountedUsers,u=(0,i.useState)(""),a=u[0],l=u[1];return(0,s.jsxs)("form",{onSubmit:function(e){e.preventDefault(),""!==a&&(0,h.W)("/groups/bouls","PUT",{uid:n,bouls:t+":"+a,action:"add"}).then((function(e){200==e&&(l(""),r(!1),o(!1))}))},children:[(0,s.jsx)("input",{type:"text",className:p().input,value:n,disabled:!0}),(0,s.jsx)("input",{type:"text",onChange:function(e){return l(e.target.value)},className:p().input,placeholder:"Boul'ss",value:a,required:!0}),(0,s.jsx)("button",{type:"submit",className:p().bouton,children:"Ajouter"})]})}function v(){switch(o().query.action){case"add":return(0,s.jsx)(m,{});case"edit":return(0,s.jsx)(x,{});case"transfert":return(0,s.jsx)(j,{});default:return(0,s.jsx)(f,{})}}},2411:function(e,t,n){"use strict";function s(e){return fetch("https://utilisateur.boquette.fr/api"+e,{method:"GET",headers:{"x-xsrf-token":JSON.parse(localStorage.getItem("token")),"Access-Control-Allow-Origin":"*","Access-Control-Allow-Credentials":"true"},credentials:"include"}).then((function(e){if(402!=e.status)return e.json();localStorage.removeItem("token"),window.location.reload()}))}function r(e,t,n){return fetch("https://utilisateur.boquette.fr/api"+e,{method:t,headers:{"Content-Type":"application/json","x-xsrf-token":JSON.parse(localStorage.getItem("token")),"Access-Control-Allow-Origin":"*","Access-Control-Allow-Credentials":"true"},body:JSON.stringify(n),credentials:"include"}).then((function(e){if(402!=e.status)return e.status;localStorage.removeItem("token"),window.location.reload()}))}n.d(t,{W:function(){return r},Z:function(){return s}})},3532:function(e){e.exports={container:"Layout_container__a4TgG",main:"Layout_main__T635V",form:"Layout_form__h8n_g",header:"Layout_header__5T1Lo",subHeader:"Layout_subHeader__UEtRY",bouton:"Layout_bouton__eeQZ9",selectedBouton:"Layout_selectedBouton__kIBwc"}},4542:function(e){e.exports={table:"groups_table__m45hf",colonne:"groups_colonne__oH7uo",row:"groups_row__aHhwl",rowHighlight:"groups_rowHighlight__wRgXT",bouton:"groups_bouton__EbIZJ",list:"groups_list__ZcniW",eltLi:"groups_eltLi__0h699",groupManage:"groups_groupManage__BkZrQ",groupMembers:"groups_groupMembers__XqAHX",defaultButton:"groups_defaultButton__HxCZq",input:"groups_input__JZbuX",subHeader:"groups_subHeader__ujTtY",choice:"groups_choice___C86Y",selectedBouton:"groups_selectedBouton__5RGMq",partHeader:"groups_partHeader__PsDPX"}},1287:function(e,t,n){"use strict";var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,n,s){return n&&e(t.prototype,n),s&&e(t,s),t}}(),r=u(n(7294)),o=u(n(6522)),i=u(n(5697));function u(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}var c=function(e){function t(){var e,n,s;a(this,t);for(var r=arguments.length,i=Array(r),u=0;u<r;u++)i[u]=arguments[u];return n=s=l(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i))),s.state={elementId:s.props.elementId||(0,o.default)()},s.clickInput=function(){var e=document.getElementById(s.state.elementId);e.value="",e.click()},s.handleFiles=function(e){s.props.base64?s.convertFilesToBase64(e.target.files):s.props.handleFiles(e.target.files)},s.convertFilesToBase64=function(e){var t=e;if(s.props.multipleFiles){var n,r;!function(){var e={base64:[],fileList:t},o=function(){var r=new FileReader,o=t[n];r.onloadend=function(n){e.base64.push(r.result),e.base64.length===t.length&&s.props.handleFiles(e)},r.readAsDataURL(o)};for(n=0,r=t.length;n<r;n++)o()}()}else{var o={base64:"",fileList:t},i=t[0],u=new FileReader;u.onloadend=function(e){o.base64=u.result,s.props.handleFiles(o)},u.readAsDataURL(i)}},l(s,n)}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),s(t,[{key:"render",value:function(){return r.default.createElement("div",{className:"react-file-reader"},r.default.createElement("input",{type:"file",onChange:this.handleFiles,accept:Array.isArray(this.props.fileTypes)?this.props.fileTypes.join(","):this.props.fileTypes,className:"react-file-reader-input",id:this.state.elementId,multiple:this.props.multipleFiles,style:{width:"0px",opacity:"0",position:"fixed"},disabled:this.props.disabled}),r.default.createElement("div",{className:"react-file-reader-button",onClick:this.clickInput},this.props.children))}}]),t}(r.default.Component);t.Z=c,c.defaultProps={fileTypes:"image/*",multipleFiles:!1,base64:!1,disabled:!1},c.propTypes={multipleFiles:i.default.bool,handleFiles:i.default.func.isRequired,fileTypes:i.default.oneOfType([i.default.string,i.default.array]),base64:i.default.bool,children:i.default.element.isRequired,disabled:i.default.bool}},6522:function(e,t){var n;!function(){function s(e){return(e=e.toString(16)).length<2&&(e="0"+e),e}function r(){var e=function(){try{return Array.from((window.crypto||window.msCrypto).getRandomValues(new Uint8Array(16)))}catch(t){for(var e=[];e.length<16;)e.push(256*Math.random()&255);return e}}();return e[6]=15&e[6]|64,e[8]=63&e[8]|128,(e=e.map(s).join("").match(/(.{8})(.{4})(.{4})(.{4})(.{12})/)).shift(),e.join("-")}var o=/^[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/;r.valid=function(e){return o.test(e)},window&&(window.uuid4=r),e.exports&&(e.exports=r),void 0===(n=function(){return r}.apply(t,[]))||(e.exports=n)}()}},function(e){e.O(0,[664,774,888,179],(function(){return t=7789,e(e.s=t);var t}));var t=e.O();_N_E=t}]);