(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[62],{8384:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/groups/edit",function(){return n(1957)}])},1957:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return p}});var r=n(5893),s=n(1163),o=n.n(s),u=n(7294),i=n(1287),l=n(4542),a=n.n(l),c=n(2411),d=n(1678);function p(){var e=(0,u.useState)(""),t=e[0],n=e[1],s=(0,u.useState)(""),l=s[0],p=s[1],h=(0,u.useState)(""),b=h[0],m=h[1],g=(0,u.useState)(""),v=g[0],x=g[1],j=(0,u.useState)([]),_=j[0],y=j[1],w=(0,u.useState)([]),N=w[0],C=w[1],S=(0,u.useState)(!0),T=S[0],E=S[1],k=(0,u.useState)(""),O=k[0],A=k[1],F=(0,u.useState)(""),M=F[0],U=F[1];(0,u.useEffect)((function(){!o().query.cn&&T||((0,c.Z)("/groups/group/"+o().query.cn).then((function(e){n(e[0].dn),p(e[0].cn),m(e[0].description),x(e[0].strass),y(e[0].memberUid)})),(0,c.Z)("/users").then((function(e){return C(e)})),E(!0))}),[o().query.cn,T]);var L=function(e,t){(0,c.W)("/groups","PATCH",{user:e,cn:l,action:t}).then((function(e){200==e&&E(!1)}))};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("form",{onSubmit:function(e){e.preventDefault(),(0,c.W)("/groups","PUT",{dn:t,cn:l,description:b,strass:v}).then((function(e){200==e?(o().push("/groups"),d.Notify.success("Groupe modifi\xe9 !")):d.Notify.failure("Erreur lors de la modification")}))},children:[(0,r.jsxs)("table",{className:a().tableForm,children:[(0,r.jsxs)("tr",{children:[(0,r.jsx)("tr",{children:"cn"}),(0,r.jsx)("td",{children:(0,r.jsx)("input",{type:"text",onChange:function(e){return p(e.target.value)},value:l,disabled:!0})})]}),(0,r.jsxs)("tr",{children:[(0,r.jsx)("tr",{children:"description"}),(0,r.jsx)("td",{children:(0,r.jsx)("input",{type:"text",onChange:function(e){return m(e.target.value)},value:b})})]}),(0,r.jsxs)("tr",{children:[(0,r.jsx)("tr",{children:"strass"}),(0,r.jsx)("td",{children:(0,r.jsx)("input",{type:"text",onChange:function(e){return x(e.target.value)},value:v})})]})]}),(0,r.jsx)("div",{children:(0,r.jsx)("button",{type:"submit",className:a().bouton,children:"Modifier"})})]}),(0,r.jsx)(i.Z,{handleFiles:function(e){var t=new FileReader;t.onload=function(e){(0,c.W)("/groups/users","PATCH",{users:t.result.split("\r\n"),cn:l}).then((function(e){200==e?(o().push("/groups"),d.Notify.success("Utilisateurs ajout\xe9s !")):d.Notify.failure("Erreur lors de l'ajout")}))},t.readAsText(e[0])},fileTypes:".csv",children:(0,r.jsx)("button",{className:a().bouton,children:"Importer"})}),(0,r.jsx)("button",{onClick:function(){(0,c.W)("/groups","DELETE",{cn:l}).then((function(e){200==e?(o().push("/groups"),d.Notify.success("Groupe supprim\xe9 !")):d.Notify.failure("Erreur lors de la suppression")}))},className:a().bouton,children:"Supprimer le groupe"}),(0,r.jsx)("button",{onClick:function(){(0,c.W)("/groups/all","DELETE",{memberUid:_,cn:l}).then((function(e){200==e?(o().push("/groups"),d.Notify.success("Utilisateurs retir\xe9s !")):d.Notify.failure("Erreur")}))},className:a().bouton,children:"Supprimer TOUS les utilisateurs"}),"TRUE"==v?(0,r.jsx)(f,{cn:l,memberUid:_,setMountedUsers:E}):void 0,(0,r.jsxs)("div",{className:a().groupManage,children:[(0,r.jsxs)("div",{className:a().groupMembers,children:[(0,r.jsx)("h1",{children:"Membres du groupe"}),(0,r.jsx)("input",{type:"text",onChange:function(e){return A(e.target.value)},placeholder:"filtrer"}),(0,r.jsx)("ul",{className:a().list,children:_?"object"==typeof _?_.map((function(e){return-1!=e.indexOf(O.toLowerCase())?(0,r.jsx)("button",{className:a().defaultButton,onClick:function(){return L(e,"delete")},children:(0,r.jsx)("li",{className:a().eltLi,children:e},e)},e+"button"):void 0})):-1!=_.indexOf(O.toLowerCase())?(0,r.jsx)("button",{className:a().defaultButton,onClick:function(){return L(_,"delete")},children:(0,r.jsx)("li",{className:a().eltLi,children:_},_)},"button"):void 0:void 0})]}),(0,r.jsxs)("div",{className:a().groupMembers,children:[(0,r.jsx)("h1",{children:"Autres utilisateurs"}),(0,r.jsx)("input",{type:"text",onChange:function(e){return U(e.target.value)},placeholder:"filtrer"}),(0,r.jsx)("ul",{className:a().list,children:null===N||void 0===N?void 0:N.map((function(e){return-1==e.uid.indexOf(M.toLowerCase())||(null===_||void 0===_?void 0:_.includes(e.uid))?void 0:(0,r.jsx)("button",{className:a().defaultButton,onClick:function(){return L(e.uid,"add")},children:(0,r.jsx)("li",{className:a().eltLi,children:e.uid},e.uid)},e.uid+"button")}))})]})]})]})}function f(e){var t=e.cn,n=e.memberUid,s=e.setMountedUsers,o=(0,u.useState)(!1),i=o[0],l=o[1],d=(0,u.useState)([]),p=d[0],f=d[1],b=(0,u.useState)([]),m=b[0],g=b[1];(0,u.useEffect)((function(){i||(0,c.Z)("/groups/bouls/"+t).then((function(e){f(e);for(var t=Object.values(n),r=0;r<e.length;r++){var s=t.indexOf(e[r].uid);-1!==s&&t.splice(s,1)}g(t),l(!0)}))}),[i]);var v=function(e,t){(0,c.W)("/groups/bouls","PUT",{uid:t,bouls:e,action:"delete"}).then((function(e){200==e&&l(!1)}))};return(0,r.jsxs)(r.Fragment,{children:[null===p||void 0===p?void 0:p.map((function(e){return"object"==typeof e.bouls?n.includes(e.uid)?e.bouls.map((function(n){return n.includes(t)?(0,r.jsxs)("div",{children:[(0,r.jsx)("input",{type:"text",className:a().input,value:e.uid,disabled:!0}),(0,r.jsx)("input",{type:"text",className:a().input,value:n.split(":")[1],disabled:!0}),(0,r.jsx)("button",{onClick:function(){return v(n,e.uid)},className:a().bouton,children:"Supprimer"})]},e.uid):void 0})):void 0:e.bouls.includes(t)&&n.includes(e.uid)?(0,r.jsxs)("div",{children:[(0,r.jsx)("input",{type:"text",className:a().input,value:e.uid,disabled:!0}),(0,r.jsx)("input",{type:"text",className:a().input,value:e.bouls.split(":")[1],disabled:!0}),(0,r.jsx)("button",{onClick:function(){return v(e.bouls,e.uid)},className:a().bouton,children:"Supprimer"})]},e.uid):void 0})),""!==m?"object"==typeof m?null===m||void 0===m?void 0:m.map((function(e){return(0,r.jsx)(h,{cn:t,user:e,setMounted:l,setMountedUsers:s},e)})):(0,r.jsx)(h,{cn:t,user:m,setMounted:l,setMountedUsers:s}):void 0]})}function h(e){var t=e.cn,n=e.user,s=e.setMounted,o=e.setMountedUsers,i=(0,u.useState)(""),l=i[0],d=i[1];return(0,r.jsxs)("form",{onSubmit:function(e){e.preventDefault(),""!==l&&(0,c.W)("/groups/bouls","PUT",{uid:n,bouls:t+":"+l,action:"add"}).then((function(e){200==e&&(d(""),s(!1),o(!1))}))},children:[(0,r.jsx)("input",{type:"text",className:a().input,value:n,disabled:!0}),(0,r.jsx)("input",{type:"text",onChange:function(e){return d(e.target.value)},className:a().input,placeholder:"Boul'ss",value:l,required:!0}),(0,r.jsx)("button",{type:"submit",className:a().bouton,children:"Ajouter"})]})}},2411:function(e,t,n){"use strict";function r(e){return fetch("https://admin.boquette.fr/api"+e,{method:"GET",headers:{"x-xsrf-token":JSON.parse(localStorage.getItem("token")),"Access-Control-Allow-Origin":"*","Access-Control-Allow-Credentials":"true"},credentials:"include"}).then((function(e){if(402!=e.status)return e.json();localStorage.removeItem("token"),window.location.reload()}))}function s(e,t,n){return fetch("https://admin.boquette.fr/api"+e,{method:t,headers:{"Content-Type":"application/json","x-xsrf-token":JSON.parse(localStorage.getItem("token")),"Access-Control-Allow-Origin":"*","Access-Control-Allow-Credentials":"true"},body:JSON.stringify(n),credentials:"include"}).then((function(e){if(402!=e.status)return e.status;localStorage.removeItem("token"),window.location.reload()}))}n.d(t,{W:function(){return s},Z:function(){return r}})},4542:function(e){e.exports={table:"groups_table__m45hf",colonne:"groups_colonne__oH7uo",row:"groups_row__aHhwl",rowHighlight:"groups_rowHighlight__wRgXT",bouton:"groups_bouton__EbIZJ",list:"groups_list__ZcniW",eltLi:"groups_eltLi__0h699",groupManage:"groups_groupManage__BkZrQ",groupMembers:"groups_groupMembers__XqAHX",defaultButton:"groups_defaultButton__HxCZq",input:"groups_input__JZbuX",subHeader:"groups_subHeader__ujTtY",choice:"groups_choice___C86Y",selectedBouton:"groups_selectedBouton__5RGMq",partHeader:"groups_partHeader__PsDPX",tableForm:"groups_tableForm__HLqvd"}},1287:function(e,t,n){"use strict";var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=i(n(7294)),o=i(n(6522)),u=i(n(5697));function i(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}var c=function(e){function t(){var e,n,r;l(this,t);for(var s=arguments.length,u=Array(s),i=0;i<s;i++)u[i]=arguments[i];return n=r=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),r.state={elementId:r.props.elementId||(0,o.default)()},r.clickInput=function(){var e=document.getElementById(r.state.elementId);e.value="",e.click()},r.handleFiles=function(e){r.props.base64?r.convertFilesToBase64(e.target.files):r.props.handleFiles(e.target.files)},r.convertFilesToBase64=function(e){var t=e;if(r.props.multipleFiles){var n,s;!function(){var e={base64:[],fileList:t},o=function(){var s=new FileReader,o=t[n];s.onloadend=function(n){e.base64.push(s.result),e.base64.length===t.length&&r.props.handleFiles(e)},s.readAsDataURL(o)};for(n=0,s=t.length;n<s;n++)o()}()}else{var o={base64:"",fileList:t},u=t[0],i=new FileReader;i.onloadend=function(e){o.base64=i.result,r.props.handleFiles(o)},i.readAsDataURL(u)}},a(r,n)}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"render",value:function(){return s.default.createElement("div",{className:"react-file-reader"},s.default.createElement("input",{type:"file",onChange:this.handleFiles,accept:Array.isArray(this.props.fileTypes)?this.props.fileTypes.join(","):this.props.fileTypes,className:"react-file-reader-input",id:this.state.elementId,multiple:this.props.multipleFiles,style:{width:"0px",opacity:"0",position:"fixed"},disabled:this.props.disabled}),s.default.createElement("div",{className:"react-file-reader-button",onClick:this.clickInput},this.props.children))}}]),t}(s.default.Component);t.Z=c,c.defaultProps={fileTypes:"image/*",multipleFiles:!1,base64:!1,disabled:!1},c.propTypes={multipleFiles:u.default.bool,handleFiles:u.default.func.isRequired,fileTypes:u.default.oneOfType([u.default.string,u.default.array]),base64:u.default.bool,children:u.default.element.isRequired,disabled:u.default.bool}},6522:function(e,t){var n;!function(){function r(e){return(e=e.toString(16)).length<2&&(e="0"+e),e}function s(){var e=function(){try{return Array.from((window.crypto||window.msCrypto).getRandomValues(new Uint8Array(16)))}catch(t){for(var e=[];e.length<16;)e.push(256*Math.random()&255);return e}}();return e[6]=15&e[6]|64,e[8]=63&e[8]|128,(e=e.map(r).join("").match(/(.{8})(.{4})(.{4})(.{4})(.{12})/)).shift(),e.join("-")}var o=/^[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/;s.valid=function(e){return o.test(e)},window&&(window.uuid4=s),e.exports&&(e.exports=s),void 0===(n=function(){return s}.apply(t,[]))||(e.exports=n)}()}},function(e){e.O(0,[678,774,888,179],(function(){return t=8384,e(e.s=t);var t}));var t=e.O();_N_E=t}]);