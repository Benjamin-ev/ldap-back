(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[736],{7789:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/groups",function(){return n(28)}])},5789:function(e,t,n){"use strict";n.d(t,{Z:function(){return h}});var s=n(5893),r=n(3532),o=n.n(r),i=n(1664),u=n.n(i),a=n(9008),c=n.n(a),l=n(1163),d=n.n(l);function h(e){return(0,s.jsxs)("div",{className:o().container,children:[(0,s.jsxs)(c(),{children:[(0,s.jsx)("meta",{name:"description",content:"Managing page for boquette FR"}),(0,s.jsx)("link",{rel:"icon",href:"/favicon.svg"}),(0,s.jsx)("title",{children:"A&M Boquette - Gestion LDAP"})]}),(0,s.jsxs)("header",{className:o().header,children:[(0,s.jsxs)("div",{className:o().subHeader,children:[(0,s.jsx)(u(),{href:"/users",passHref:!0,children:(0,s.jsx)("h2",{className:[o().bouton,"/users"==d().pathname?o().selectedBouton:void 0].join(" "),children:"Gestion des Utilisateurs"})}),(0,s.jsx)(u(),{href:"/groups",passHref:!0,children:(0,s.jsx)("h2",{className:[o().bouton,"/groups"==d().pathname?o().selectedBouton:void 0].join(" "),children:"Gestion des Groupes"})})]}),(0,s.jsxs)("div",{className:o().subHeader,children:[(0,s.jsx)(u(),{href:d().pathname,passHref:!0,children:(0,s.jsx)("h2",{className:[o().bouton,d().query.action?void 0:o().selectedBouton].join(" "),children:"Visualiser"})}),(0,s.jsx)(u(),{href:d().pathname+"?action=add",passHref:!0,children:(0,s.jsx)("h2",{className:[o().bouton,"add"==d().query.action?o().selectedBouton:void 0].join(" "),children:"Ajouter"})}),(0,s.jsx)(u(),{href:d().pathname+"?action=edit",passHref:!0,children:(0,s.jsx)("h2",{className:[o().bouton,"edit"==d().query.action?o().selectedBouton:void 0].join(" "),children:"Editer"})}),"/groups"==d().pathname?(0,s.jsx)(u(),{href:d().pathname+"?action=transfert",passHref:!0,children:(0,s.jsx)("h2",{className:[o().bouton,"transfert"==d().query.action?o().selectedBouton:void 0].join(" "),children:"Transf\xe9rer"})}):void 0]})]}),(0,s.jsx)("main",{className:o().main,children:e.children})]})}},28:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return b}});var s=n(5893),r=n(1163),o=n.n(r),i=n(7294),u=n(1664),a=n.n(u),c=n(5789),l=n(4542),d=n.n(l),h=n(2411);function p(){var e=(0,i.useState)([]),t=e[0],n=e[1],r=(0,i.useState)(""),u=r[0],l=r[1];return(0,i.useEffect)((function(){(0,h.Z)("/groups").then((function(e){n(e)}))}),[o().asPath]),(0,s.jsx)(c.Z,{children:(0,s.jsxs)("table",{className:d().table,children:[(0,s.jsxs)("thead",{children:[(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:d().colonne,children:"cn"}),(0,s.jsx)("th",{className:d().colonne,children:"description"}),(0,s.jsx)("th",{className:d().colonne,children:"gidNumber"}),(0,s.jsx)("th",{className:d().colonne,children:"strass"})]}),(0,s.jsx)("tr",{children:(0,s.jsx)("td",{children:(0,s.jsx)("input",{type:"text",onChange:function(e){return l(e.target.value)},placeholder:"filtrer"})})})]}),(0,s.jsx)("tbody",{children:null===t||void 0===t?void 0:t.map((function(e,t){return-1!=e.cn.toLowerCase().indexOf(u.toLowerCase())?(0,s.jsx)(a(),{href:o().pathname+"?action=edit&cn="+e.cn,passHref:!0,children:(0,s.jsxs)("tr",{className:d().rowHighlight,children:[(0,s.jsx)("td",{className:d().row,children:e.cn},t+"cn"),(0,s.jsx)("td",{className:d().row,children:e.description},t+"description"),(0,s.jsx)("td",{className:d().row,children:e.gidNumber},t+"gid"),(0,s.jsx)("td",{className:d().row,children:e.strass},t+"strass")]},t+"tr")},t+"link"):void 0}))})]})})}function x(){var e=(0,i.useState)(""),t=e[0],n=e[1],r=(0,i.useState)(""),u=r[0],a=r[1],l=(0,i.useState)(""),p=l[0],x=l[1];return(0,s.jsx)(c.Z,{children:(0,s.jsxs)("form",{onSubmit:function(e){e.preventDefault(),(0,h.W)("/groups","POST",{cn:t,description:u,strass:p}).then((function(e){200==e&&o().push("/groups")}))},children:[(0,s.jsxs)("table",{className:d().table,children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:d().colonne,children:"cn"}),(0,s.jsx)("th",{className:d().colonne,children:"description"}),(0,s.jsx)("th",{className:d().colonne,children:"strass"})]})}),(0,s.jsx)("tbody",{children:(0,s.jsxs)("tr",{className:d().rowHighlight,children:[(0,s.jsx)("td",{className:d().row,children:(0,s.jsx)("input",{type:"text",onChange:function(e){return n(e.target.value)}})},"cn"),(0,s.jsx)("td",{className:d().row,children:(0,s.jsx)("input",{type:"text",onChange:function(e){return a(e.target.value)}})},"description"),(0,s.jsx)("td",{className:d().row,children:(0,s.jsx)("input",{type:"text",onChange:function(e){return x(e.target.value)}})},"strass")]},"tr")})]}),(0,s.jsx)("div",{children:(0,s.jsx)("button",{type:"submit",className:d().bouton,children:"Ajouter un groupe"})})]})})}function f(){var e=(0,i.useState)(""),t=e[0],n=e[1],r=(0,i.useState)(""),u=r[0],a=r[1],l=(0,i.useState)(""),p=l[0],x=l[1],f=(0,i.useState)(""),j=f[0],g=f[1],b=(0,i.useState)([]),v=b[0],N=b[1],_=(0,i.useState)([]),y=_[0],w=_[1],C=(0,i.useState)(!0),S=C[0],H=C[1],k=(0,i.useState)(""),B=k[0],L=k[1],T=(0,i.useState)(""),E=T[0],M=T[1];(0,i.useEffect)((function(){!o().query.cn&&S||((0,h.Z)("/groups/group/"+o().query.cn).then((function(e){n(e[0].dn),a(e[0].cn),x(e[0].description),g(e[0].strass),N(e[0].memberUid)})),(0,h.Z)("/users").then((function(e){return w(e)})),H(!0))}),[o().query.cn,S]);var A=function(e,t){(0,h.W)("/groups","PATCH",{user:e,cn:u,action:t}).then((function(e){200==e&&H(!1)}))};return(0,s.jsxs)(c.Z,{children:[(0,s.jsxs)("form",{onSubmit:function(e){e.preventDefault(),(0,h.W)("/groups","PUT",{dn:t,cn:u,description:p,strass:j}).then((function(e){200==e&&o().push("/groups")}))},children:[(0,s.jsxs)("table",{className:d().table,children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:d().colonne,children:"cn"}),(0,s.jsx)("th",{className:d().colonne,children:"description"}),(0,s.jsx)("th",{className:d().colonne,children:"strass"})]})}),(0,s.jsx)("tbody",{children:u?(0,s.jsxs)("tr",{className:d().rowHighlight,children:[(0,s.jsx)("td",{className:d().row,children:(0,s.jsx)("input",{type:"text",onChange:function(e){return a(e.target.value)},value:u,disabled:!0})},"cn"),(0,s.jsx)("td",{className:d().row,children:(0,s.jsx)("input",{type:"text",onChange:function(e){return x(e.target.value)},value:p})},"description"),(0,s.jsx)("td",{className:d().row,children:(0,s.jsx)("input",{type:"text",onChange:function(e){return g(e.target.value)},value:j})},"strass")]},"tr"):void 0})]}),(0,s.jsx)("div",{children:(0,s.jsx)("button",{type:"submit",className:d().bouton,children:"Modifier"})})]}),(0,s.jsx)("button",{onClick:function(){(0,h.W)("/groups","DELETE",{cn:u}).then((function(e){200==e&&o().push("/groups")}))},className:d().bouton,children:"Supprimer le groupe"}),(0,s.jsx)("button",{onClick:function(){(0,h.W)("/groups/all","DELETE",{memberUid:v,cn:u}).then((function(e){200==e&&o().push("/groups")}))},className:d().bouton,children:"Supprimer TOUS les utilisateurs"}),"TRUE"==j?(0,s.jsx)(m,{cn:u,memberUid:v,setMountedUsers:H}):void 0,(0,s.jsxs)("div",{className:d().groupManage,children:[(0,s.jsxs)("div",{className:d().groupMembers,children:[(0,s.jsx)("h1",{children:"Membres du groupe"}),(0,s.jsx)("input",{type:"text",onChange:function(e){return L(e.target.value)},placeholder:"filtrer"}),(0,s.jsx)("ul",{className:d().list,children:v?"object"==typeof v?v.map((function(e){return-1!=e.indexOf(B.toLowerCase())?(0,s.jsx)("button",{className:d().defaultButton,onClick:function(){return A(e,"delete")},children:(0,s.jsx)("li",{className:d().eltLi,children:e},e)},e+"button"):void 0})):-1!=v.indexOf(B.toLowerCase)?(0,s.jsx)("button",{className:d().defaultButton,onClick:function(){return A(v,"delete")},children:(0,s.jsx)("li",{className:d().eltLi,children:v},v)},"button"):void 0:void 0})]}),(0,s.jsxs)("div",{className:d().groupMembers,children:[(0,s.jsx)("h1",{children:"Autres utilisateurs"}),(0,s.jsx)("input",{type:"text",onChange:function(e){return M(e.target.value)},placeholder:"filtrer"}),(0,s.jsx)("ul",{className:d().list,children:null===y||void 0===y?void 0:y.map((function(e){return-1==e.uid.indexOf(E.toLowerCase())||(null===v||void 0===v?void 0:v.includes(e.uid))?void 0:(0,s.jsx)("button",{className:d().defaultButton,onClick:function(){return A(e.uid,"add")},children:(0,s.jsx)("li",{className:d().eltLi,children:e.uid},e.uid)},e.uid+"button")}))})]})]})]})}function j(){var e=(0,i.useState)([]),t=e[0],n=e[1],r=(0,i.useState)(""),u=r[0],a=r[1],l=(0,i.useState)(""),p=l[0],x=l[1],f=(0,i.useState)(!0),j=f[0],m=f[1];(0,i.useEffect)((function(){(0,h.Z)("/groups").then((function(e){n(e),a(e[0].cn)}))}),[]);return(0,s.jsxs)(c.Z,{children:[(0,s.jsxs)("div",{className:d().subHeader,children:[(0,s.jsx)("button",{className:[d().choice,j?d().selectedBouton:void 0].join(" "),onClick:function(){return m(!0)},children:"Copier le Groupe"}),(0,s.jsx)("button",{className:[d().choice,j?void 0:d().selectedBouton].join(" "),onClick:function(){return m(!1)},children:"Couper le Groupe"})]}),(0,s.jsxs)("form",{onSubmit:function(){(0,h.W)("/groups/transfert","PATCH",{oldGroup:u,newGroup:p,action:j}).then((function(e){200==e&&o().push("/groups")}))},className:d().subHeader,children:[(0,s.jsxs)("div",{className:d().partHeader,children:[(0,s.jsx)("h3",{children:"Ancien Groupe"}),(0,s.jsx)("select",{className:d().choice,onChange:function(e){return a(e.target.value)},children:null===t||void 0===t?void 0:t.map((function(e){return e.cn!==p?(0,s.jsx)("option",{value:e.cn,children:e.cn},e.cn):void 0}))})]}),(0,s.jsxs)("div",{className:d().partHeader,children:[(0,s.jsx)("h3",{children:"Nouveau Groupe"}),(0,s.jsx)("select",{className:d().choice,onChange:function(e){return x(e.target.value)},children:null===t||void 0===t?void 0:t.map((function(e){return e.cn!==u?(0,s.jsx)("option",{value:e.cn,children:e.cn},e.cn):void 0}))})]}),(0,s.jsx)("div",{className:d().partHeader,children:(0,s.jsx)("button",{type:"submit",className:d().choice,children:"Transf\xe9rer"})})]})]})}function m(e){var t=e.cn,n=e.memberUid,r=e.setMountedUsers,o=(0,i.useState)(!1),u=o[0],a=o[1],c=(0,i.useState)([]),l=c[0],p=c[1],x=(0,i.useState)([]),f=x[0],j=x[1];(0,i.useEffect)((function(){u||(0,h.Z)("/groups/bouls/"+t).then((function(e){p(e);for(var t=Object.values(n),s=0;s<e.length;s++){var r=t.indexOf(e[s].uid);-1!==r&&t.splice(r,1)}j(t),a(!0)}))}),[u]);var m=function(e,t){(0,h.W)("/groups/bouls","PUT",{uid:t,bouls:e,action:"delete"}).then((function(e){200==e&&a(!1)}))};return(0,s.jsxs)(s.Fragment,{children:[null===l||void 0===l?void 0:l.map((function(e){return"object"==typeof e.bouls?n.includes(e.uid)?e.bouls.map((function(n){return n.includes(t)?(0,s.jsxs)("div",{children:[(0,s.jsx)("input",{type:"text",className:d().input,value:e.uid,disabled:!0}),(0,s.jsx)("input",{type:"text",className:d().input,value:n.split(":")[1],disabled:!0}),(0,s.jsx)("button",{onClick:function(){return m(n,e.uid)},className:d().bouton,children:"Supprimer"})]},e.uid):void 0})):void 0:e.bouls.includes(t)&&n.includes(e.uid)?(0,s.jsxs)("div",{children:[(0,s.jsx)("input",{type:"text",className:d().input,value:e.uid,disabled:!0}),(0,s.jsx)("input",{type:"text",className:d().input,value:e.bouls.split(":")[1],disabled:!0}),(0,s.jsx)("button",{onClick:function(){return m(e.bouls,e.uid)},className:d().bouton,children:"Supprimer"})]},e.uid):void 0})),""!==f?"object"==typeof f?null===f||void 0===f?void 0:f.map((function(e){return(0,s.jsx)(g,{cn:t,user:e,setMounted:a,setMountedUsers:r},e)})):(0,s.jsx)(g,{cn:t,user:f,setMounted:a,setMountedUsers:r}):void 0]})}function g(e){var t=e.cn,n=e.user,r=e.setMounted,o=e.setMountedUsers,u=(0,i.useState)(""),a=u[0],c=u[1];return(0,s.jsxs)("form",{onSubmit:function(e){e.preventDefault(),""!==a&&(0,h.W)("/groups/bouls","PUT",{uid:n,bouls:t+":"+a,action:"add"}).then((function(e){200==e&&(c(""),r(!1),o(!1))}))},children:[(0,s.jsx)("input",{type:"text",className:d().input,value:n,disabled:!0}),(0,s.jsx)("input",{type:"text",onChange:function(e){return c(e.target.value)},className:d().input,placeholder:"Boul'ss",value:a,required:!0}),(0,s.jsx)("button",{type:"submit",className:d().bouton,children:"Ajouter"})]})}function b(){switch(o().query.action){case"add":return(0,s.jsx)(x,{});case"edit":return(0,s.jsx)(f,{});case"transfert":return(0,s.jsx)(j,{});default:return(0,s.jsx)(p,{})}}},2411:function(e,t,n){"use strict";function s(e){return fetch("https://utilisateur.boquette.fr/api"+e,{method:"GET",headers:{"x-xsrf-token":JSON.parse(localStorage.getItem("token")),"Access-Control-Allow-Origin":"*","Access-Control-Allow-Credentials":"true"},credentials:"include"}).then((function(e){if(200==e.status)return e.json();localStorage.removeItem("token"),window.location.reload()}))}function r(e,t,n){return fetch("https://utilisateur.boquette.fr/api"+e,{method:t,headers:{"Content-Type":"application/json","x-xsrf-token":JSON.parse(localStorage.getItem("token")),"Access-Control-Allow-Origin":"*","Access-Control-Allow-Credentials":"true"},body:JSON.stringify(n),credentials:"include"}).then((function(e){if(200==e.status)return e.status;localStorage.removeItem("token"),window.location.reload()}))}n.d(t,{W:function(){return r},Z:function(){return s}})},3532:function(e){e.exports={container:"Layout_container__a4TgG",main:"Layout_main__T635V",form:"Layout_form__h8n_g",header:"Layout_header__5T1Lo",subHeader:"Layout_subHeader__UEtRY",bouton:"Layout_bouton__eeQZ9",selectedBouton:"Layout_selectedBouton__kIBwc"}},4542:function(e){e.exports={table:"groups_table__m45hf",colonne:"groups_colonne__oH7uo",row:"groups_row__aHhwl",rowHighlight:"groups_rowHighlight__wRgXT",bouton:"groups_bouton__EbIZJ",list:"groups_list__ZcniW",eltLi:"groups_eltLi__0h699",groupManage:"groups_groupManage__BkZrQ",groupMembers:"groups_groupMembers__XqAHX",defaultButton:"groups_defaultButton__HxCZq",input:"groups_input__JZbuX",subHeader:"groups_subHeader__ujTtY",choice:"groups_choice___C86Y",selectedBouton:"groups_selectedBouton__5RGMq",partHeader:"groups_partHeader__PsDPX"}}},function(e){e.O(0,[664,774,888,179],(function(){return t=7789,e(e.s=t);var t}));var t=e.O();_N_E=t}]);