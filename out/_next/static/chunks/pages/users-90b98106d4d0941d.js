(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[892],{7476:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/users",function(){return n(1760)}])},5789:function(e,t,n){"use strict";n.d(t,{Z:function(){return h}});var s=n(5893),i=n(3532),r=n.n(i),a=n(1664),o=n.n(a),l=n(9008),c=n.n(l),u=n(1163),d=n.n(u);function h(e){return(0,s.jsxs)("div",{className:r().container,children:[(0,s.jsxs)(c(),{children:[(0,s.jsx)("meta",{name:"description",content:"Managing page for boquette FR"}),(0,s.jsx)("link",{rel:"icon",href:"/favicon.svg"}),(0,s.jsx)("title",{children:"A&M Boquette - Gestion LDAP"})]}),(0,s.jsxs)("header",{className:r().header,children:[(0,s.jsxs)("div",{className:r().subHeader,children:[(0,s.jsx)(o(),{href:"/users",passHref:!0,children:(0,s.jsx)("h2",{className:[r().bouton,"/users"==d().pathname?r().selectedBouton:void 0].join(" "),children:"Gestion des Utilisateurs"})}),(0,s.jsx)(o(),{href:"/groups",passHref:!0,children:(0,s.jsx)("h2",{className:[r().bouton,"/groups"==d().pathname?r().selectedBouton:void 0].join(" "),children:"Gestion des Groupes"})})]}),(0,s.jsxs)("div",{className:r().subHeader,children:[(0,s.jsx)(o(),{href:d().pathname,passHref:!0,children:(0,s.jsx)("h2",{className:[r().bouton,d().query.action?void 0:r().selectedBouton].join(" "),children:"Visualiser"})}),(0,s.jsx)(o(),{href:d().pathname+"?action=add",passHref:!0,children:(0,s.jsx)("h2",{className:[r().bouton,"add"==d().query.action?r().selectedBouton:void 0].join(" "),children:"Ajouter"})}),(0,s.jsx)(o(),{href:d().pathname+"?action=edit",passHref:!0,children:(0,s.jsx)("h2",{className:[r().bouton,"edit"==d().query.action?r().selectedBouton:void 0].join(" "),children:"Editer"})}),"/groups"==d().pathname?(0,s.jsx)(o(),{href:d().pathname+"?action=transfert",passHref:!0,children:(0,s.jsx)("h2",{className:[r().bouton,"transfert"==d().query.action?r().selectedBouton:void 0].join(" "),children:"Transf\xe9rer"})}):void 0]})]}),(0,s.jsx)("main",{className:r().main,children:e.children})]})}},1760:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return j}});var s=n(5893),i=n(1163),r=n.n(i),a=n(7294),o=n(1664),l=n.n(o),c=n(5789),u=n(8658),d=n.n(u),h=n(1287),f=n(2411);function p(){var e=(0,a.useState)([]),t=e[0],n=e[1],i=(0,a.useState)(""),o=i[0],u=i[1],h=(0,a.useState)(""),p=h[0],m=h[1];return(0,a.useEffect)((function(){(0,f.Z)("/users").then((function(e){n(e)}))}),[r().asPath]),(0,s.jsx)(c.Z,{children:(0,s.jsxs)("table",{className:d().table,children:[(0,s.jsxs)("thead",{children:[(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:d().colonne,children:"uid=cn"}),(0,s.jsx)("th",{className:d().colonne,children:"uidNumber"}),(0,s.jsx)("th",{className:d().colonne,children:"gidNumber"}),(0,s.jsx)("th",{className:d().colonne,children:"description"}),(0,s.jsx)("th",{className:d().colonne,children:"displayName"}),(0,s.jsx)("th",{className:d().colonne,children:"sn"}),(0,s.jsx)("th",{className:d().colonne,children:"givenName"}),(0,s.jsx)("th",{className:d().colonne,children:"mail"}),(0,s.jsx)("th",{className:d().colonne,children:"mobile"}),(0,s.jsx)("th",{className:d().colonne,children:"bouls"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:(0,s.jsx)("input",{type:"text",onChange:function(e){return m(e.target.value)},placeholder:"filtrer"})}),(0,s.jsx)("td",{}),(0,s.jsx)("td",{}),(0,s.jsx)("td",{children:(0,s.jsx)("input",{type:"text",onChange:function(e){return u(e.target.value)},placeholder:"filtrer"})})]})]}),(0,s.jsx)("tbody",{children:null===t||void 0===t?void 0:t.map((function(e,t){var n,i;return-1!=(null===(n=e.uid)||void 0===n?void 0:n.toLowerCase().indexOf(p.toLowerCase()))&&-1!=(null===(i=e.description)||void 0===i?void 0:i.toLowerCase().indexOf(o.toLowerCase()))?(0,s.jsx)(l(),{href:r().pathname+"?action=edit&uid="+e.uid,passHref:!0,children:(0,s.jsxs)("tr",{className:d().rowHighlight,children:[(0,s.jsx)("td",{className:d().row,children:e.uid},t+"uid"),(0,s.jsx)("td",{className:d().row,children:e.uidNumber},t+"uidNumber"),(0,s.jsx)("td",{className:d().row,children:e.gidNumber},t+"gid"),(0,s.jsx)("td",{className:d().row,children:e.description},t+"description"),(0,s.jsx)("td",{className:d().row,children:e.displayName},t+"displayName"),(0,s.jsx)("td",{className:d().row,children:e.sn},t+"sn"),(0,s.jsx)("td",{className:d().row,children:e.givenName},t+"givenName"),(0,s.jsx)("td",{className:d().row,children:e.mail},t+"mail"),(0,s.jsx)("td",{className:d().row,children:e.mobile},t+"mobile"),(0,s.jsx)("td",{className:d().row,children:e.bouls},t+"bouls")]},t+"tr")},t+"link"):void 0}))})]})})}function m(){var e=(0,a.useState)({uid:"",description:"",displayName:"",sn:"",givenName:"",mail:"",mobile:""}),t=e[0],n=e[1],i=(0,a.useState)(!1),o=i[0],l=i[1];(0,a.useEffect)((function(){o&&setTimeout((function(){alert(o),l(!1)}),100)}),[o]),(0,a.useEffect)((function(){r().query.uid&&(0,f.Z)("/users/user/"+r().query.uid).then((function(e){return n(e[0])}))}),[r().query.uid]);var u=function(e){return function(s){var i=t;i[e]=s.target.value,n(i)}};return(0,s.jsxs)(c.Z,{children:[(0,s.jsx)("div",{children:(0,s.jsxs)("form",{onSubmit:function(e){e.preventDefault(),(0,f.W)("/users","POST",t).then((function(e){200==e?(r().push("/users"),l("Utilisateur ajout\xe9 !")):l("Erreur lors de l'ajout")}))},children:[(0,s.jsxs)("table",{className:d().table,children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:d().colonne,children:"uid=cn"}),(0,s.jsx)("th",{className:d().colonne,children:"description"}),(0,s.jsx)("th",{className:d().colonne,children:"displayName"}),(0,s.jsx)("th",{className:d().colonne,children:"sn"}),(0,s.jsx)("th",{className:d().colonne,children:"givenName"}),(0,s.jsx)("th",{className:d().colonne,children:"mail"}),(0,s.jsx)("th",{className:d().colonne,children:"mobile"})]})}),(0,s.jsx)("tbody",{children:(0,s.jsxs)("tr",{className:d().rowHighlight,children:[(0,s.jsx)("td",{className:d().row,children:(0,s.jsx)("input",{type:"text",onChange:u("uid")})},"uid"),(0,s.jsx)("td",{className:d().row,children:(0,s.jsx)("input",{type:"text",onChange:u("description")})},"description"),(0,s.jsx)("td",{className:d().row,children:(0,s.jsx)("input",{type:"text",onChange:u("displayName")})},"displayName"),(0,s.jsx)("td",{className:d().row,children:(0,s.jsx)("input",{type:"text",onChange:u("sn")})},"sn"),(0,s.jsx)("td",{className:d().row,children:(0,s.jsx)("input",{type:"text",onChange:u("givenName")})},"givenName"),(0,s.jsx)("td",{className:d().row,children:(0,s.jsx)("input",{type:"text",onChange:u("mail")})},"mail"),(0,s.jsx)("td",{className:d().row,children:(0,s.jsx)("input",{type:"text",onChange:u("mobile")})},"mobile")]},"tr")})]}),(0,s.jsx)("div",{children:(0,s.jsx)("button",{type:"submit",className:d().bouton,children:"Ajouter un utilisateur"})})]})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{children:"Importer un fichier .csv"}),(0,s.jsx)("p",{children:"Notez que le fichier ne doit pas comporter d'en-t\xeates mais qu'elles doivent \xeatre dans le m\xeame ordre que ci-dessus"}),(0,s.jsx)("p",{children:"Si une case est vide, mettre un espace \xe0 la place, sous peine d'annuler l'ajout"}),(0,s.jsx)(h.Z,{handleFiles:function(e){var t=new FileReader;t.onload=function(e){(0,f.W)("/users/users","POST",t.result.split("\r\n")).then((function(e){200==e?(r().push("/users"),l("Utilisateurs ajout\xe9s !")):l("Erreur lors de l'ajout")}))},t.readAsText(e[0])},fileTypes:".csv",children:(0,s.jsx)("button",{className:d().bouton,children:"Importer"})})]})]})}function x(){var e=(0,a.useState)(""),t=e[0],n=e[1],i=(0,a.useState)(""),o=i[0],l=i[1],u=(0,a.useState)(""),p=u[0],m=u[1],x=(0,a.useState)(""),j=x[0],N=x[1],v=(0,a.useState)(""),b=v[0],y=v[1],g=(0,a.useState)(""),w=g[0],_=g[1],C=(0,a.useState)(""),T=C[0],E=C[1],S=(0,a.useState)(""),A=S[0],k=S[1],q=(0,a.useState)(!1),F=q[0],O=q[1];(0,a.useEffect)((function(){F&&setTimeout((function(){alert(F),O(!1)}),100)}),[F]),(0,a.useEffect)((function(){r().query.uid&&(0,f.Z)("/users/user/"+r().query.uid).then((function(e){console.log(e),n(e[0].dn),l(e[0].uid),m(e[0].description),N(e[0].displayName),y(e[0].sn),_(e[0].givenName),E(e[0].mail),k(e[0].mobile)}))}),[r().query.uid]);return(0,s.jsxs)(c.Z,{children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("form",{onSubmit:function(e){e.preventDefault(),(0,f.W)("/users","PUT",{dn:t,uid:o,description:p,displayName:j,sn:b,givenName:w,mail:T,mobile:A}).then((function(e){200==e?(r().push("/users"),O("Modification faite !")):O("Erreur lors de la modification")}))},children:[(0,s.jsxs)("table",{className:d().table,children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:d().colonne,children:"uid=cn"}),(0,s.jsx)("th",{className:d().colonne,children:"description"}),(0,s.jsx)("th",{className:d().colonne,children:"displayName"}),(0,s.jsx)("th",{className:d().colonne,children:"sn"}),(0,s.jsx)("th",{className:d().colonne,children:"givenName"}),(0,s.jsx)("th",{className:d().colonne,children:"mail"}),(0,s.jsx)("th",{className:d().colonne,children:"mobile"})]})}),(0,s.jsx)("tbody",{children:o?(0,s.jsxs)("tr",{className:d().rowHighlight,children:[(0,s.jsx)("td",{className:d().row,children:(0,s.jsx)("input",{type:"text",onChange:function(e){return l(e.target.value)},value:o,disabled:!0})},"uid"),(0,s.jsx)("td",{className:d().row,children:(0,s.jsx)("input",{type:"text",onChange:function(e){return m(e.target.value)},value:p})},"description"),(0,s.jsx)("td",{className:d().row,children:(0,s.jsx)("input",{type:"text",onChange:function(e){return N(e.target.value)},value:j})},"displayName"),(0,s.jsx)("td",{className:d().row,children:(0,s.jsx)("input",{type:"text",onChange:function(e){return y(e.target.value)},value:b})},"sn"),(0,s.jsx)("td",{className:d().row,children:(0,s.jsx)("input",{type:"text",onChange:function(e){return _(e.target.value)},value:w})},"givenName"),(0,s.jsx)("td",{className:d().row,children:(0,s.jsx)("input",{type:"text",onChange:function(e){return E(e.target.value)},value:T})},"mail"),(0,s.jsx)("td",{className:d().row,children:(0,s.jsx)("input",{type:"text",onChange:function(e){return k(e.target.value)},value:A})},"mobile")]},"tr"):void 0})]}),(0,s.jsx)("div",{children:(0,s.jsx)("button",{type:"submit",className:d().bouton,children:"Modifier"})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("button",{onClick:function(){T&&(0,f.W)("/users","PATCH",{dn:t,uid:o,mail:T}).then((function(e){200==e?(r().push("/users"),O("Mot de passe r\xe9initialis\xe9 !")):O("Erreur lors de la r\xe9initialisation")}))},className:d().bouton,children:"R\xe9initialiser le Mot de Passe de l'utilisateur"}),(0,s.jsx)("button",{onClick:function(){(0,f.W)("/users","DELETE",{dn:t}).then((function(e){200==e?(r().push("/users"),O("Suppression faite !")):O("Erreur lors de la suppression")}))},className:d().bouton,children:"Supprimer l'utilisateur"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{children:"Importer un fichier .csv de modification"}),(0,s.jsx)("p",{children:"Notez que le fichier doit comporter les en-t\xeates \xe0 modifier en 1\xe8re ligne, l'uid doit \xe9galement appara\xeetre en 1ere colonne"}),(0,s.jsx)(h.Z,{handleFiles:function(e){var t=new FileReader;t.onload=function(e){var n=t.result.split("\r\n");(0,f.W)("/users/users","PUT",{headers:n.shift(),users:n}).then((function(e){200==e?(r().push("/users"),O("Utilisateurs modifi\xe9s !")):O("Erreur lors de la modification")}))},t.readAsText(e[0])},fileTypes:".csv",children:(0,s.jsx)("button",{className:d().bouton,children:"Importer"})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{children:"R\xe9initialiser les Mots de Passe - Fichier .csv"}),(0,s.jsx)("p",{children:"Le fichier doit contenir la liste des uid \xe0 modifier en 1ere colonne ainsi que les mails correspondants en 2eme"}),(0,s.jsx)(h.Z,{handleFiles:function(e){var t=new FileReader;t.onload=function(e){var n=t.result.split("\r\n");(0,f.W)("/users/users","PATCH",n).then((function(e){200==e?(r().push("/users"),O("R\xe9initialisation des mots de passe faite !")):O("Erreur lors de la r\xe9initialisation")}))},t.readAsText(e[0])},fileTypes:".csv",children:(0,s.jsx)("button",{className:d().bouton,children:"Importer"})})]})]})}function j(){switch(r().query.action){case"add":return(0,s.jsx)(m,{});case"edit":return(0,s.jsx)(x,{});default:return(0,s.jsx)(p,{})}}},2411:function(e,t,n){"use strict";function s(e){return fetch("https://utilisateur.boquette.fr/api"+e,{method:"GET",headers:{"x-xsrf-token":JSON.parse(localStorage.getItem("token")),"Access-Control-Allow-Origin":"*","Access-Control-Allow-Credentials":"true"},credentials:"include"}).then((function(e){if(402!=e.status)return e.json();localStorage.removeItem("token"),window.location.reload()}))}function i(e,t,n){return fetch("https://utilisateur.boquette.fr/api"+e,{method:t,headers:{"Content-Type":"application/json","x-xsrf-token":JSON.parse(localStorage.getItem("token")),"Access-Control-Allow-Origin":"*","Access-Control-Allow-Credentials":"true"},body:JSON.stringify(n),credentials:"include"}).then((function(e){if(402!=e.status)return e.status;localStorage.removeItem("token"),window.location.reload()}))}n.d(t,{W:function(){return i},Z:function(){return s}})},3532:function(e){e.exports={container:"Layout_container__a4TgG",main:"Layout_main__T635V",form:"Layout_form__h8n_g",header:"Layout_header__5T1Lo",subHeader:"Layout_subHeader__UEtRY",bouton:"Layout_bouton__eeQZ9",selectedBouton:"Layout_selectedBouton__kIBwc"}},8658:function(e){e.exports={table:"users_table__h0z1h",colonne:"users_colonne__Vh8oO",row:"users_row__R9_Xv",rowHighlight:"users_rowHighlight__fAyyv",bouton:"users_bouton__LVkM6"}},1287:function(e,t,n){"use strict";var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,n,s){return n&&e(t.prototype,n),s&&e(t,s),t}}(),i=o(n(7294)),r=o(n(6522)),a=o(n(5697));function o(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}var u=function(e){function t(){var e,n,s;l(this,t);for(var i=arguments.length,a=Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=s=c(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),s.state={elementId:s.props.elementId||(0,r.default)()},s.clickInput=function(){var e=document.getElementById(s.state.elementId);e.value="",e.click()},s.handleFiles=function(e){s.props.base64?s.convertFilesToBase64(e.target.files):s.props.handleFiles(e.target.files)},s.convertFilesToBase64=function(e){var t=e;if(s.props.multipleFiles){var n,i;!function(){var e={base64:[],fileList:t},r=function(){var i=new FileReader,r=t[n];i.onloadend=function(n){e.base64.push(i.result),e.base64.length===t.length&&s.props.handleFiles(e)},i.readAsDataURL(r)};for(n=0,i=t.length;n<i;n++)r()}()}else{var r={base64:"",fileList:t},a=t[0],o=new FileReader;o.onloadend=function(e){r.base64=o.result,s.props.handleFiles(r)},o.readAsDataURL(a)}},c(s,n)}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),s(t,[{key:"render",value:function(){return i.default.createElement("div",{className:"react-file-reader"},i.default.createElement("input",{type:"file",onChange:this.handleFiles,accept:Array.isArray(this.props.fileTypes)?this.props.fileTypes.join(","):this.props.fileTypes,className:"react-file-reader-input",id:this.state.elementId,multiple:this.props.multipleFiles,style:{width:"0px",opacity:"0",position:"fixed"},disabled:this.props.disabled}),i.default.createElement("div",{className:"react-file-reader-button",onClick:this.clickInput},this.props.children))}}]),t}(i.default.Component);t.Z=u,u.defaultProps={fileTypes:"image/*",multipleFiles:!1,base64:!1,disabled:!1},u.propTypes={multipleFiles:a.default.bool,handleFiles:a.default.func.isRequired,fileTypes:a.default.oneOfType([a.default.string,a.default.array]),base64:a.default.bool,children:a.default.element.isRequired,disabled:a.default.bool}},6522:function(e,t){var n;!function(){function s(e){return(e=e.toString(16)).length<2&&(e="0"+e),e}function i(){var e=function(){try{return Array.from((window.crypto||window.msCrypto).getRandomValues(new Uint8Array(16)))}catch(t){for(var e=[];e.length<16;)e.push(256*Math.random()&255);return e}}();return e[6]=15&e[6]|64,e[8]=63&e[8]|128,(e=e.map(s).join("").match(/(.{8})(.{4})(.{4})(.{4})(.{12})/)).shift(),e.join("-")}var r=/^[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/;i.valid=function(e){return r.test(e)},window&&(window.uuid4=i),e.exports&&(e.exports=i),void 0===(n=function(){return i}.apply(t,[]))||(e.exports=n)}()}},function(e){e.O(0,[664,774,888,179],(function(){return t=7476,e(e.s=t);var t}));var t=e.O();_N_E=t}]);